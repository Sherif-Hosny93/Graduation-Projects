<!-- Only the table rendering part is shown; the rest of your file remains unchanged -->
<script>
function renderTable(data) {
  const container = document.getElementById('table-container');
  if (!data.length) {
    container.innerHTML = "<p>No data found.</p>";
    return;
  }
  const table = document.createElement('table');
  // Header
  const thead = document.createElement('thead');
  const headerRow = document.createElement('tr');
  Object.keys(data[0]).forEach(key => {
    if (key !== "Project Summary") {
      const th = document.createElement('th');
      th.textContent = key;
      headerRow.appendChild(th);
    }
  });
  headerRow.appendChild(document.createElement('th')).textContent = "Details";
  thead.appendChild(headerRow);
  table.appendChild(thead);
  // Body
  const tbody = document.createElement('tbody');
  data.forEach((row, idx) => {
    const tr = document.createElement('tr');
    Object.entries(row).forEach(([k, v]) => {
      if (k !== "Project Summary") {
        const td = document.createElement('td');
        td.textContent = v;
        tr.appendChild(td);
      }
    });
    // Details cell: truncated summary + show more/less
    const tdDetails = document.createElement('td');
    const summary = row["Project Summary"] || "No summary available";
    const previewLen = 80;
    const isLong = summary.length > previewLen;
    const preview = isLong ? summary.slice(0, previewLen) + "..." : summary;

    const spanPreview = document.createElement('span');
    spanPreview.textContent = preview;
    tdDetails.appendChild(spanPreview);

    if (isLong) {
      const btn = document.createElement('button');
      btn.textContent = "Show more";
      btn.className = "show-details-btn";
      btn.style.marginLeft = "8px";
      const divFull = document.createElement('div');
      divFull.className = "summary-div";
      divFull.style.display = "none";
      divFull.textContent = summary;

      btn.onclick = function() {
        if (divFull.style.display === "block") {
          divFull.style.display = "none";
          spanPreview.style.display = "";
          btn.textContent = "Show more";
        } else {
          divFull.style.display = "block";
          spanPreview.style.display = "none";
          btn.textContent = "Show less";
        }
      };

      tdDetails.appendChild(btn);
      tdDetails.appendChild(divFull);
    }
    tr.appendChild(tdDetails);
    tbody.appendChild(tr);
  });
  table.appendChild(tbody);
  container.innerHTML = "";
  container.appendChild(table);
}
</script>